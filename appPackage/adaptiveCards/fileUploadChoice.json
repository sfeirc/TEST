{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.5",      
  "body": [
    {
      "type": "Container",
      "style": "emphasis",
      "bleed": true,
      "items": [
        {
          "type": "ColumnSet",
          "columns": [
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "Image",
                  "url": "https://upload.wikimedia.org/wikipedia/fr/e/e6/Logo-infotel.png",
                  "size": "high",
                  "width": "192px",
                  "altText": "Logo Infotel"
                }
              ],
              "verticalContentAlignment": "Center"
            },
            {
              "type": "Column",
              "width": "stretch",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "ðŸ“„ Fichier reÃ§u: ${filename}",
                  "size": "large",
                  "weight": "bolder",
                  "color": "accent"
                },
                {
                  "type": "TextBlock",
                  "text": "Que souhaitez-vous faire avec ce document?",
                  "size": "medium",
                  "wrap": true,
                  "spacing": "none"
                }
              ],
              "verticalContentAlignment": "Center"
            }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "large",
      "style": "good",
      "bleed": true,
      "isVisible": "${if(suggested_action, true, false)}",
      "items": [
        {
          "type": "TextBlock",
          "text": "ðŸ’¡ Action SuggÃ©rÃ©e",
          "weight": "bolder",
          "size": "medium",
          "color": "good"
        },
        {
          "type": "TextBlock",
          "text": "${suggestion_reason}",
          "wrap": true,
          "isSubtle": true,
          "spacing": "small",
          "size": "small"
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "medium",
      "isVisible": "${if(suggested_action == 'summarize', true, false)}",
      "items": [
        {
          "type": "ColumnSet",
          "columns": [
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "ðŸ“‹",
                  "size": "extraLarge"
                }
              ],
              "verticalContentAlignment": "Center"
            },
            {
              "type": "Column",
              "width": "stretch",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "Analyser cet Appel d'Offres",
                  "weight": "bolder",
                  "size": "large",
                  "color": "good"
                },
                {
                  "type": "TextBlock",
                  "text": "âœ“ Extraction des lots et budgets\nâœ“ Calendrier et Ã©chÃ©ances\nâœ“ Profils requis et critÃ¨res de sÃ©lection",
                  "size": "small",
                  "wrap": true,
                  "spacing": "small"
                }
              ],
              "verticalContentAlignment": "Center"
            }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "medium",
      "isVisible": "${if(suggested_action == 'deck', true, false)}",
      "items": [
        {
          "type": "ColumnSet",
          "columns": [
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "ðŸ“Š",
                  "size": "extraLarge"
                }
              ],
              "verticalContentAlignment": "Center"
            },
            {
              "type": "Column",
              "width": "stretch",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "GÃ©nÃ©rer une PrÃ©sentation PowerPoint",
                  "weight": "bolder",
                  "size": "large",
                  "color": "good"
                },
                {
                  "type": "TextBlock",
                  "text": "âœ“ Plan de slides professionnel\nâœ“ Charte Infotel 2025\nâœ“ Validation en 2 Ã©tapes",
                  "size": "small",
                  "wrap": true,
                  "spacing": "small"
                }
              ],
              "verticalContentAlignment": "Center"
            }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "medium",
      "isVisible": "${if(suggested_action == 'harmonize', true, false)}",
      "items": [
        {
          "type": "ColumnSet",
          "columns": [
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "âœ¨",
                  "size": "extraLarge"
                }
              ],
              "verticalContentAlignment": "Center"
            },
            {
              "type": "Column",
              "width": "stretch",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "Harmoniser ce PowerPoint",
                  "weight": "bolder",
                  "size": "large",
                  "color": "good"
                },
                {
                  "type": "TextBlock",
                  "text": "âœ“ Application charte Infotel 2025\nâœ“ Restructuration intelligente\nâœ“ Logo et couleurs PANTONE",
                  "size": "small",
                  "wrap": true,
                  "spacing": "small"
                }
              ],
              "verticalContentAlignment": "Center"
            }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "separator": true,
      "spacing": "large",
      "items": [
        {
          "type": "TextBlock",
          "text": "ðŸ”½ Autres Options Disponibles",
          "weight": "bolder",
          "size": "medium",
          "horizontalAlignment": "center",
          "color": "accent"
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "small",
      "isVisible": "${if(suggested_action != 'summarize', true, false)}",
      "items": [
        {
          "type": "ColumnSet",
          "columns": [
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "ðŸ“‹",
                  "size": "large"
                }
              ]
            },
            {
              "type": "Column",
              "width": "stretch",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "Analyser un appel d'offres",
                  "weight": "bolder"
                },
                {
                  "type": "TextBlock",
                  "text": "Extraction des informations clÃ©s, budgets, critÃ¨res",
                  "size": "small",
                  "isSubtle": true,
                  "wrap": true,
                  "spacing": "none"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "small",
      "isVisible": "${if(suggested_action != 'deck', true, false)}",
      "items": [
        {
          "type": "ColumnSet",
          "columns": [
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "ðŸ“Š",
                  "size": "large"
                }
              ]
            },
            {
              "type": "Column",
              "width": "stretch",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "GÃ©nÃ©rer une prÃ©sentation PowerPoint",
                  "weight": "bolder"
                },
                {
                  "type": "TextBlock",
                  "text": "Plan de slides complet avec charte Infotel",
                  "size": "small",
                  "isSubtle": true,
                  "wrap": true,
                  "spacing": "none"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "small",
      "isVisible": "${if(suggested_action != 'diagram', true, false)}",
      "items": [
        {
          "type": "ColumnSet",
          "columns": [
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "ðŸŽ¨",
                  "size": "large"
                }
              ]
            },
            {
              "type": "Column",
              "width": "stretch",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "CrÃ©er un diagramme d'architecture",
                  "weight": "bolder"
                },
                {
                  "type": "TextBlock",
                  "text": "SchÃ©ma technique de la solution proposÃ©e",
                  "size": "small",
                  "isSubtle": true,
                  "wrap": true,
                  "spacing": "none"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "small",
      "isVisible": "${if(suggested_action != 'harmonize', true, false)}",
      "items": [
        {
          "type": "ColumnSet",
          "columns": [
            {
              "type": "Column",
              "width": "auto",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "âœ¨",
                  "size": "large"
                }
              ]
            },
            {
              "type": "Column",
              "width": "stretch",
              "items": [
                {
                  "type": "TextBlock",
                  "text": "Harmoniser et standardiser",
                  "weight": "bolder"
                },
                {
                  "type": "TextBlock",
                  "text": "Application de la charte graphique Infotel",
                  "size": "small",
                  "isSubtle": true,
                  "wrap": true,
                  "spacing": "none"
                }
              ]
            }
          ]
        }
      ]
    }
  ],
  "actions": [
    {
      "type": "Action.Submit",
      "title": "${if(suggested_action == 'summarize', 'âœ… Analyser cet Appel d\\'Offres', 'ðŸ“‹ Analyser (RFP)')}",
      "data": {
        "action": "summarize",
        "command": "/summarize"
      },
      "style": "${if(suggested_action == 'summarize', 'positive', 'default')}"
    },
    {
      "type": "Action.Submit",
      "title": "${if(suggested_action == 'deck', 'âœ… GÃ©nÃ©rer PrÃ©sentation', 'ðŸ“Š PrÃ©sentation')}",
      "data": {
        "action": "deck",
        "command": "/deck"
      },
      "style": "${if(suggested_action == 'deck', 'positive', 'default')}"
    },
    {
      "type": "Action.Submit",
      "title": "${if(suggested_action == 'diagram', 'âœ… CrÃ©er Diagramme', 'ðŸŽ¨ Diagramme')}",
      "data": {
        "action": "diagram",
        "command": "/diagram"
      },
      "style": "${if(suggested_action == 'diagram', 'positive', 'default')}"
    },
    {
      "type": "Action.Submit",
      "title": "${if(suggested_action == 'harmonize', 'âœ… Harmoniser PowerPoint', 'âœ¨ Harmoniser')}",
      "data": {
        "action": "harmonize",
        "command": "/harmonize"
      },
      "style": "${if(suggested_action == 'harmonize', 'positive', 'default')}"
    }
  ]
}
